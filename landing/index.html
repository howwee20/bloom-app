<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bloom</title>
  <meta name="description" content="One account. Everywhere. Banking you can talk to.">
  <meta property="og:title" content="Bloom">
  <meta property="og:description" content="One account. Everywhere. Banking you can talk to.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://paywithbloom.com">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Bloom">
  <meta name="twitter:description" content="One account. Everywhere. Banking you can talk to.">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect fill='%23000' width='100' height='100' rx='16'/><text x='50' y='65' font-size='44' text-anchor='middle' fill='%23fff' font-weight='500' font-family='-apple-system,system-ui'>b</text></svg>">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Instrument+Serif:ital@0;1&family=Space+Grotesk:wght@400;500;600;700&family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --peach: #FFD7B5;
      --peach-light: #FFF0E3;
      --peach-bg: #FFF5EB;
      --orange: #E86B20;
      --orange-hover: #D45E18;
      --black: #1a1a1a;
      --white: #ffffff;
      --gray-50: #f9fafb;
      --gray-100: #f3f4f6;
      --gray-200: #e5e7eb;
      --gray-400: #9ca3af;
      --gray-500: #6b7280;
      --gray-600: #4b5563;
      --gray-700: #374151;
      --gray-800: #1f2937;
      --green: #16a34a;
    }

    html {
      scroll-behavior: smooth;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, "SF Pro Display", "Segoe UI", system-ui, sans-serif;
      background: var(--white);
      color: var(--black);
      overflow-x: hidden;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    /* ── Header / Nav ── */
    header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 100;
      background: rgba(255, 255, 255, 0.92);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border-bottom: 1px solid rgba(0, 0, 0, 0.06);
    }

    .nav-inner {
      max-width: 1200px;
      margin: 0 auto;
      padding: 16px 40px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .logo {
      font-family: 'Inter', sans-serif;
      font-size: 22px;
      font-weight: 700;
      color: var(--black);
      text-decoration: none;
      letter-spacing: -0.01em;
    }

    .nav-links {
      display: flex;
      align-items: center;
      gap: 36px;
    }

    .nav-links a {
      font-size: 15px;
      font-weight: 500;
      color: var(--gray-600);
      text-decoration: none;
      transition: color 0.2s ease;
    }

    .nav-links a:hover {
      color: var(--black);
    }

    .nav-cta {
      display: inline-flex;
      align-items: center;
      padding: 10px 22px;
      background: var(--orange);
      color: var(--white) !important;
      border-radius: 999px;
      font-size: 13px !important;
      font-weight: 600 !important;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      text-decoration: none;
      transition: background 0.2s ease, transform 0.2s ease;
    }

    .nav-cta:hover {
      background: var(--orange-hover);
      color: var(--white) !important;
      transform: translateY(-1px);
    }

    /* ── Hero ── */
    .hero {
      padding: 140px 40px 80px;
      text-align: center;
      background: var(--white);
    }

    .hero-inner {
      max-width: 1100px;
      margin: 0 auto;
    }

    .hero-card {
      background: var(--peach-bg);
      border-radius: 32px;
      padding: 80px 40px 60px;
    }

    .hero-headline {
      font-family: 'Instrument Serif', Georgia, 'Times New Roman', serif;
      font-size: clamp(52px, 8vw, 96px);
      font-weight: 400;
      line-height: 1.0;
      letter-spacing: -0.02em;
      color: var(--black);
      margin-bottom: 28px;
    }

    .hero-sub {
      font-size: clamp(16px, 2vw, 20px);
      color: var(--gray-600);
      max-width: 560px;
      margin: 0 auto 56px;
      line-height: 1.5;
    }

    /* ── Two-column cards ── */
    .cards-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 24px;
      max-width: 900px;
      margin: 0 auto;
    }

    .feature-card {
      background: var(--white);
      border-radius: 20px;
      padding: 40px 32px 36px;
      text-align: center;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.06);
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .feature-label {
      font-size: 12px;
      font-weight: 600;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      color: var(--orange);
      margin-bottom: 14px;
    }

    .feature-title {
      font-family: 'Instrument Serif', Georgia, 'Times New Roman', serif;
      font-size: clamp(26px, 3.5vw, 36px);
      font-weight: 400;
      line-height: 1.15;
      color: var(--black);
      margin-bottom: 10px;
    }

    .feature-sub {
      font-size: 14px;
      color: var(--gray-500);
      margin-bottom: 16px;
      line-height: 1.5;
    }

    .feature-link {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 16px;
      font-weight: 600;
      color: var(--orange);
      text-decoration: none;
      margin-bottom: 28px;
      transition: gap 0.2s ease;
    }

    .feature-link:hover {
      gap: 10px;
    }

    .feature-link .arrow {
      font-size: 18px;
      transition: transform 0.2s ease;
    }

    .feature-link:hover .arrow {
      transform: translateX(2px);
    }

    /* ── Demo Card (USE BLOOM) ── */
    .demo-card {
      width: 100%;
      max-width: 320px;
      background: var(--white);
      border: 1px solid var(--gray-200);
      border-radius: 16px;
      padding: 20px;
      text-align: left;
    }

    .demo-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 4px;
    }

    .demo-available {
      font-size: 11px;
      font-weight: 500;
      color: var(--gray-500);
      text-transform: uppercase;
      letter-spacing: 0.06em;
    }

    .demo-status {
      display: flex;
      align-items: center;
      gap: 5px;
      font-size: 12px;
      font-weight: 500;
      color: var(--green);
    }

    .demo-status-dot {
      width: 7px;
      height: 7px;
      background: var(--green);
      border-radius: 50%;
    }

    .demo-balance {
      font-family: 'Inter', sans-serif;
      font-size: 42px;
      font-weight: 700;
      color: var(--black);
      letter-spacing: -0.02em;
      margin-bottom: 16px;
    }

    .demo-prompt {
      display: inline-block;
      padding: 8px 16px;
      background: var(--gray-50);
      border: 1px solid var(--gray-200);
      border-radius: 10px;
      font-size: 13px;
      font-weight: 500;
      color: var(--gray-700);
      margin-bottom: 12px;
    }

    .demo-response {
      background: var(--gray-50);
      border: 1px solid var(--gray-200);
      border-radius: 10px;
      padding: 12px 16px;
      font-size: 13px;
      color: var(--gray-700);
      line-height: 1.5;
      margin-bottom: 16px;
    }

    .demo-actions {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .demo-chip {
      padding: 8px 14px;
      background: var(--white);
      border: 1px solid var(--gray-200);
      border-radius: 10px;
      font-size: 12px;
      font-weight: 500;
      color: var(--gray-700);
      white-space: nowrap;
    }

    /* ── Code Card (BUILD WITH BLOOM) ── */
    .code-card {
      width: 100%;
      max-width: 340px;
      background: var(--gray-800);
      border-radius: 14px;
      overflow: hidden;
      text-align: left;
    }

    .code-header {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 14px 18px 10px;
    }

    .code-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
    }

    .code-dot--red { background: #ff5f57; }
    .code-dot--yellow { background: #febc2e; }
    .code-dot--green { background: #28c840; }

    .code-filename {
      font-family: 'JetBrains Mono', 'SF Mono', 'Fira Code', monospace;
      font-size: 12px;
      color: var(--gray-400);
      margin-left: 8px;
    }

    .code-body {
      padding: 4px 20px 24px;
      font-family: 'JetBrains Mono', 'SF Mono', 'Fira Code', monospace;
      font-size: 13px;
      line-height: 1.8;
      color: #e2e8f0;
    }

    .code-keyword { color: #c084fc; }
    .code-brace { color: #94a3b8; }
    .code-string { color: #86efac; }
    .code-comment { color: #64748b; font-style: italic; }
    .code-method { color: #93c5fd; }
    .code-prop { color: #fbbf24; }
    .code-number { color: #f472b6; }

    /* ── Tagline ── */
    .tagline {
      text-align: center;
      padding: 64px 40px;
      font-size: 16px;
      font-weight: 500;
      letter-spacing: 0.28em;
      text-transform: uppercase;
      color: var(--gray-400);
    }

    /* ── Architecture Section ── */
    .architecture {
      --arch-ink: #f8fafc;
      --arch-muted: rgba(226, 232, 240, 0.72);
      --arch-accent: #e8a87c;
      --arch-accent-strong: #f5c9a8;
      position: relative;
      z-index: 2;
      padding: 96px 0 120px;
      background: #0f172a;
      font-family: "Space Grotesk", "SF Pro Display", "Segoe UI", system-ui, sans-serif;
    }

    .arch-shell {
      max-width: 1100px;
      margin: 0 auto;
      padding: 0 32px;
    }

    .arch-label {
      margin: 0 0 10px;
      font-size: 11px;
      letter-spacing: 0.35em;
      text-transform: uppercase;
      color: rgba(148, 163, 184, 0.8);
    }

    .arch-title {
      margin: 0 0 12px;
      font-size: 34px;
      font-weight: 600;
      letter-spacing: -0.02em;
      color: var(--arch-ink);
    }

    .arch-description {
      margin: 0 0 28px;
      max-width: 680px;
      color: var(--arch-muted);
      font-size: 15px;
      line-height: 1.6;
    }

    .architecture .diagram {
      position: relative;
      min-height: 700px;
      padding: 48px;
      border-radius: 24px;
      background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
      border: 1px solid rgba(148, 163, 184, 0.2);
      box-shadow: 0 30px 80px rgba(15, 23, 42, 0.45);
      overflow: hidden;
    }

    .architecture .diagram::after {
      content: "";
      position: absolute;
      inset: 0;
      background:
        radial-gradient(500px 320px at 50% 40%, rgba(232, 168, 124, 0.1), transparent 70%),
        radial-gradient(600px 400px at 30% 80%, rgba(94, 234, 212, 0.08), transparent 70%);
      opacity: 0.8;
      pointer-events: none;
    }

    .architecture .diagram-inner {
      position: relative;
      height: 100%;
      z-index: 1;
    }

    .architecture .diagram-lines {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      z-index: 0;
      pointer-events: none;
    }

    .architecture .diagram-stage {
      position: relative;
      width: 100%;
      height: 100%;
      z-index: 1;
    }

    .architecture .layer {
      position: absolute;
      left: 50%;
      transform: translate(-50%, -10px);
      opacity: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 12px;
      transition: opacity 0.6s ease, transform 0.6s ease;
      pointer-events: none;
    }

    .architecture .layer[data-visible="true"] {
      opacity: 1;
      transform: translate(-50%, 0);
      pointer-events: auto;
    }

    .architecture .layer-row {
      display: flex;
      gap: 14px;
      flex-wrap: wrap;
      justify-content: center;
    }

    .architecture .layer-label {
      color: rgba(255, 255, 255, 0.5);
      font-size: 10px;
      letter-spacing: 0.15em;
      text-transform: uppercase;
    }

    .architecture .pill {
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      color: #ffffff;
      padding: 8px 16px;
      border-radius: 8px;
      font-size: 13px;
      font-weight: 500;
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
    }

    .architecture .spend-badge {
      background: linear-gradient(135deg, #f5c9a8 0%, #e8a87c 100%);
      border: none;
      border-radius: 20px;
      padding: 10px 24px;
      color: #1a1a1a;
      font-weight: 600;
      font-size: 12px;
      letter-spacing: 0.05em;
    }

    .architecture .kernel-box {
      background: linear-gradient(135deg, #e8a87c 0%, #d4956a 100%);
      border: 2px solid #f5c9a8;
      border-radius: 16px;
      padding: 32px 48px;
      color: #1a1a1a;
      text-align: center;
      box-shadow: 0 0 60px rgba(232, 168, 124, 0.3);
      animation: kernelGlow 3s ease-in-out infinite;
    }

    .architecture .kernel-title {
      font-size: 16px;
      font-weight: 700;
      letter-spacing: 0.12em;
    }

    .architecture .kernel-sub {
      margin-top: 10px;
      font-size: 13px;
      font-weight: 500;
      letter-spacing: 0.04em;
    }

    .architecture .foundation {
      position: absolute;
      right: 0;
      transform: translate(24px, -50%);
      background: rgba(255, 255, 255, 0.05);
      border: 1px dashed rgba(255, 255, 255, 0.2);
      border-radius: 12px;
      padding: 22px 24px;
      color: rgba(255, 255, 255, 0.8);
      text-align: left;
      width: 180px;
      opacity: 0;
      transition: opacity 0.6s ease, transform 0.6s ease;
      pointer-events: none;
    }

    .architecture .foundation[data-visible="true"] {
      opacity: 1;
      transform: translate(0, -50%);
      pointer-events: auto;
    }

    .architecture .foundation-label {
      font-size: 11px;
      letter-spacing: 0.2em;
      text-transform: uppercase;
      margin-bottom: 10px;
      color: rgba(255, 255, 255, 0.6);
    }

    .architecture .foundation-body {
      font-size: 13px;
      line-height: 1.5;
    }

    .architecture .flow-down {
      animation: flowDown 2s linear infinite;
    }

    .architecture .flow-up {
      animation: flowUp 2s linear infinite;
    }

    .architecture .stepper {
      margin-top: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 18px;
    }

    .architecture .stepper-btn {
      border: 1px solid rgba(255, 255, 255, 0.2);
      background: rgba(15, 23, 42, 0.8);
      color: #ffffff;
      width: 36px;
      height: 36px;
      border-radius: 10px;
      font-size: 16px;
      cursor: pointer;
      transition: transform 0.2s ease, border-color 0.2s ease;
    }

    .architecture .stepper-btn:hover {
      transform: translateY(-1px);
      border-color: rgba(232, 168, 124, 0.6);
    }

    .architecture .stepper-btn:disabled {
      opacity: 0.4;
      cursor: not-allowed;
      transform: none;
    }

    .architecture .stepper-label {
      font-size: 13px;
      color: rgba(226, 232, 240, 0.7);
    }

    @keyframes kernelGlow {
      0%, 100% { box-shadow: 0 0 60px rgba(232, 168, 124, 0.3); }
      50% { box-shadow: 0 0 80px rgba(232, 168, 124, 0.5); }
    }

    @keyframes flowDown {
      from { stroke-dashoffset: 0; }
      to { stroke-dashoffset: -24; }
    }

    @keyframes flowUp {
      from { stroke-dashoffset: 0; }
      to { stroke-dashoffset: 24; }
    }

    /* ── Footer ── */
    footer {
      padding: 40px;
      text-align: center;
      font-size: 13px;
      color: var(--gray-400);
      background: var(--white);
    }

    footer a {
      color: var(--gray-500);
      text-decoration: none;
      transition: color 0.2s ease;
    }

    footer a:hover {
      color: var(--black);
    }

    /* ── Responsive ── */
    @media (max-width: 900px) {
      .arch-shell { padding: 0 24px; }
      .architecture .diagram { padding: 32px; min-height: 640px; }
      .architecture .kernel-box { padding: 26px 34px; }
      .architecture .foundation { width: 160px; }
    }

    @media (max-width: 768px) {
      .nav-inner { padding: 14px 24px; }
      .nav-links { gap: 20px; }
      .nav-links a:not(.nav-cta) { display: none; }

      .hero { padding: 110px 20px 60px; }
      .hero-card { padding: 56px 24px 40px; border-radius: 24px; }
      .hero-headline { font-size: clamp(40px, 10vw, 64px); }

      .cards-row {
        grid-template-columns: 1fr;
        max-width: 440px;
      }

      .feature-card { padding: 32px 24px 28px; }

      .tagline { padding: 48px 24px; font-size: 14px; letter-spacing: 0.2em; }
    }

    @media (max-width: 640px) {
      .architecture { padding: 72px 0 96px; }
      .arch-title { font-size: 28px; }
      .architecture .diagram { padding: 24px; min-height: 600px; }
      .architecture .layer-row { gap: 10px; }
      .architecture .kernel-box { padding: 22px 28px; }
      .architecture .foundation {
        position: static;
        transform: none;
        width: auto;
        margin-top: 24px;
      }
      .architecture .foundation[data-visible="true"] { transform: none; }
    }

    @media (prefers-reduced-motion: reduce) {
      .architecture .kernel-box,
      .architecture .flow-down,
      .architecture .flow-up { animation: none; }
    }
  </style>
</head>
<body>

  <!-- ── Header ── -->
  <header>
    <nav class="nav-inner">
      <a class="logo" href="https://paywithbloom.com">Bloom</a>
      <div class="nav-links">
        <a href="#architecture">Docs</a>
        <a href="#foundation">Foundation</a>
        <a href="#developers">Developers</a>
        <a href="#contact">Contact</a>
        <a class="nav-cta" href="#waitlist">Join the List</a>
      </div>
    </nav>
  </header>

  <!-- ── Hero ── -->
  <section class="hero">
    <div class="hero-inner">
      <div class="hero-card">
        <h1 class="hero-headline">One account.<br>Everywhere.</h1>
        <p class="hero-sub">Banking you can talk to&mdash;across apps, assistants, and the world.</p>

        <div class="cards-row">
          <!-- USE BLOOM -->
          <div class="feature-card">
            <div class="feature-label">Use Bloom</div>
            <h2 class="feature-title">Banking you can talk to.</h2>
            <p class="feature-sub">One number. Always accurate. Ask any AI.</p>
            <a href="#waitlist" class="feature-link">Get started <span class="arrow">&rarr;</span></a>

            <div class="demo-card">
              <div class="demo-header">
                <span class="demo-available">Available</span>
                <span class="demo-status"><span class="demo-status-dot"></span> Connected</span>
              </div>
              <div class="demo-balance">$847</div>
              <div class="demo-prompt">How much do I have?</div>
              <div class="demo-response">$847 available. $200 is set aside for rent on Thursday.</div>
              <div class="demo-actions">
                <span class="demo-chip">Send $50 to Mom</span>
                <span class="demo-chip">Approve rent</span>
                <span class="demo-chip">Subscriptions &middot; $29</span>
              </div>
            </div>
          </div>

          <!-- BUILD WITH BLOOM -->
          <div class="feature-card">
            <div class="feature-label">Build with Bloom</div>
            <h2 class="feature-title">Add money to any app or agent.</h2>
            <p class="feature-sub">Open protocol. Run the kernel anywhere.</p>
            <a href="#architecture" class="feature-link">Read docs <span class="arrow">&rarr;</span></a>

            <div class="code-card">
              <div class="code-header">
                <span class="code-dot code-dot--red"></span>
                <span class="code-dot code-dot--yellow"></span>
                <span class="code-dot code-dot--green"></span>
                <span class="code-filename">agent.ts</span>
              </div>
              <div class="code-body">
                <div><span class="code-keyword">import</span> <span class="code-brace">{</span> Bloom <span class="code-brace">}</span> <span class="code-keyword">from</span> <span class="code-string">"@bloom/sdk"</span></div>
                <div>&nbsp;</div>
                <div><span class="code-keyword">const</span> kernel = <span class="code-keyword">new</span> <span class="code-method">Bloom</span>(<span class="code-string">"sk_live_..."</span>)</div>
                <div>&nbsp;</div>
                <div><span class="code-comment">// What can this agent spend?</span></div>
                <div><span class="code-keyword">const</span> power = <span class="code-keyword">await</span> kernel.<span class="code-method">spendPower</span>()</div>
                <div>&nbsp;</div>
                <div><span class="code-comment">// Hold &rarr; Execute &rarr; Receipt</span></div>
                <div><span class="code-keyword">const</span> receipt = <span class="code-keyword">await</span> kernel.<span class="code-method">execute</span>(<span class="code-brace">{</span></div>
                <div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-prop">to</span>: <span class="code-string">"0x..."</span>, <span class="code-prop">amount</span>: <span class="code-number">50</span></div>
                <div><span class="code-brace">}</span>)</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- ── Tagline ── -->
  <div class="tagline">ASK, APPROVE, DONE.</div>

  <!-- ── Architecture ── -->
  <section class="architecture" id="architecture">
    <div class="arch-shell">
      <p class="arch-label">ARCHITECTURE</p>
      <h2 class="arch-title">Bloom Architecture</h2>
      <p class="arch-description" id="archDescription"></p>

      <div class="diagram" id="diagram">
        <div class="diagram-inner" id="diagramInner">
          <svg class="diagram-lines" id="diagramLines" aria-hidden="true"></svg>

          <div class="diagram-stage" id="diagramStage">
            <div class="layer interfaces" data-layer="interfaces">
              <div class="layer-label">INTERFACES</div>
              <div class="layer-row">
                <div class="pill" data-node="interface">Claude</div>
                <div class="pill" data-node="interface">Apps</div>
                <div class="pill" data-node="interface">Cards</div>
                <div class="pill" data-node="interface">Agents</div>
              </div>
            </div>

            <div class="layer actions" data-layer="actions">
              <div class="layer-label">ACTIONS</div>
              <div class="layer-row">
                <div class="pill" data-node="action">Transfers</div>
                <div class="pill" data-node="action">Polymarket</div>
              </div>
            </div>

            <div class="layer spend" data-layer="spend">
              <div class="spend-badge">SPEND POWER</div>
            </div>

            <div class="layer kernel" data-layer="kernel">
              <div class="kernel-box">
                <div class="kernel-title">BLOOM KERNEL</div>
                <div class="kernel-sub">Policy &middot; Ledger &middot; Receipts</div>
              </div>
            </div>

            <div class="layer adapters" data-layer="adapters">
              <div class="layer-label">ASSET ADAPTERS</div>
              <div class="layer-row">
                <div class="pill" data-node="adapter">USDC World</div>
                <div class="pill" data-node="adapter">BTC World</div>
              </div>
            </div>

            <div class="layer blockchains" data-layer="blockchains">
              <div class="layer-label">BLOCKCHAINS</div>
              <div class="layer-row">
                <div class="pill" data-node="blockchain">Base USDC</div>
                <div class="pill" data-node="blockchain">Bitcoin</div>
              </div>
            </div>

            <div class="foundation" data-layer="foundation" id="foundation">
              <div class="foundation-label">FOUNDATION</div>
              <div class="foundation-body">Stewards protocol</div>
            </div>
          </div>
        </div>
      </div>

      <div class="stepper">
        <button class="stepper-btn" id="prevStep" type="button" aria-label="Previous step">&larr;</button>
        <span class="stepper-label" id="stepLabel"></span>
        <button class="stepper-btn" id="nextStep" type="button" aria-label="Next step">&rarr;</button>
      </div>
    </div>
  </section>

  <footer>
    <span>&copy; 2025 Bloom</span>
  </footer>

  <!-- ── Architecture stepper JS ── -->
  <script>
    (() => {
      const STEP_COUNT = 7;

      const descriptions = [
        "",
        "The kernel is a dumb lock. It enforces constraints, tracks state, and proves everything.",
        "The kernel computes one thing: Spend Power. What you can actually spend right now.",
        "Worlds translate blockchain state into something the kernel can read.",
        "Drivers let the kernel act on reality. Transfers, trades, subscriptions.",
        "Any AI can connect. Claude, ChatGPT, apps, agents - one kernel.",
        "The Bloom Foundation stewards the protocol. Open forever.",
        "One kernel. Every client. Banking you can talk to."
      ];

      const layerSteps = {
        interfaces: 5,
        actions: 4,
        spend: 2,
        kernel: 1,
        adapters: 3,
        blockchains: 3,
        foundation: 6
      };

      const state = { step: 1 };

      const elements = {
        description: document.getElementById("archDescription"),
        stepLabel: document.getElementById("stepLabel"),
        prevButton: document.getElementById("prevStep"),
        nextButton: document.getElementById("nextStep"),
        stage: document.getElementById("diagramStage"),
        inner: document.getElementById("diagramInner"),
        svg: document.getElementById("diagramLines"),
        layers: {
          interfaces: document.querySelector('[data-layer="interfaces"]'),
          actions: document.querySelector('[data-layer="actions"]'),
          spend: document.querySelector('[data-layer="spend"]'),
          kernel: document.querySelector('[data-layer="kernel"]'),
          adapters: document.querySelector('[data-layer="adapters"]'),
          blockchains: document.querySelector('[data-layer="blockchains"]'),
          foundation: document.querySelector('[data-layer="foundation"]')
        }
      };

      if (!elements.inner || !elements.svg) return;

      const nodes = {
        interfaces: Array.from(document.querySelectorAll('[data-node="interface"]')),
        actions: Array.from(document.querySelectorAll('[data-node="action"]')),
        adapters: Array.from(document.querySelectorAll('[data-node="adapter"]')),
        blockchains: Array.from(document.querySelectorAll('[data-node="blockchain"]'))
      };

      const clamp = (value, min, max) => Math.max(min, Math.min(max, value));

      const setLayerVisibility = () => {
        Object.entries(layerSteps).forEach(([key, minStep]) => {
          const el = elements.layers[key];
          if (!el) return;
          el.setAttribute("data-visible", state.step >= minStep ? "true" : "false");
        });
      };

      const updateCopy = () => {
        if (elements.description) {
          elements.description.textContent = descriptions[state.step] || "";
        }
        if (elements.stepLabel) {
          elements.stepLabel.textContent = `Step ${state.step} of ${STEP_COUNT}`;
        }
        if (elements.prevButton) {
          elements.prevButton.disabled = state.step === 1;
        }
        if (elements.nextButton) {
          elements.nextButton.disabled = state.step === STEP_COUNT;
        }
      };

      const setStep = (nextStep) => {
        state.step = clamp(nextStep, 1, STEP_COUNT);
        setLayerVisibility();
        updateCopy();
        layoutLayers();
        renderLines();
      };

      const setTop = (el, value) => {
        if (!el) return;
        el.style.top = `${value}px`;
      };

      const layoutLayers = () => {
        if (!elements.inner) return;
        const height = elements.inner.clientHeight;

        const gaps = {
          interfaces: 60,
          actions: 40,
          spend: 24,
          kernel: 24,
          adapters: 40
        };

        const hInterfaces = elements.layers.interfaces?.offsetHeight ?? 0;
        const hActions = elements.layers.actions?.offsetHeight ?? 0;
        const hSpend = elements.layers.spend?.offsetHeight ?? 0;
        const hKernel = elements.layers.kernel?.offsetHeight ?? 0;
        const hAdapters = elements.layers.adapters?.offsetHeight ?? 0;
        const hBlockchains = elements.layers.blockchains?.offsetHeight ?? 0;

        const total =
          hInterfaces + gaps.interfaces +
          hActions + gaps.actions +
          hSpend + gaps.spend +
          hKernel + gaps.kernel +
          hAdapters + gaps.adapters +
          hBlockchains;

        const extra = Math.max(0, height - total);
        const gapAboveKernel = gaps.spend + extra / 2;
        const gapBelowKernel = gaps.kernel + extra / 2;

        let current = 0;
        setTop(elements.layers.interfaces, current);
        current += hInterfaces + gaps.interfaces;
        setTop(elements.layers.actions, current);
        current += hActions + gaps.actions;
        setTop(elements.layers.spend, current);
        current += hSpend + gapAboveKernel;
        setTop(elements.layers.kernel, current);
        current += hKernel + gapBelowKernel;
        setTop(elements.layers.adapters, current);
        current += hAdapters + gaps.adapters;
        setTop(elements.layers.blockchains, current);

        const kernelTop = Number.parseFloat(elements.layers.kernel?.style.top ?? "0");
        const kernelCenter = kernelTop + hKernel / 2;
        if (elements.layers.foundation) {
          const foundationHeight = elements.layers.foundation.offsetHeight;
          elements.layers.foundation.style.top = `${kernelCenter - foundationHeight / 2}px`;
        }
      };

      const getPoint = (el, position) => {
        if (!el || !elements.inner) return { x: 0, y: 0 };
        const rect = el.getBoundingClientRect();
        const container = elements.inner.getBoundingClientRect();
        let x = rect.left - container.left + rect.width / 2;
        let y = rect.top - container.top + rect.height / 2;
        if (position === "top") y = rect.top - container.top;
        if (position === "bottom") y = rect.bottom - container.top;
        if (position === "left") x = rect.left - container.left;
        if (position === "right") x = rect.right - container.left;
        return { x, y };
      };

      const curvedPath = (start, end) => {
        const dx = end.x - start.x;
        const dy = end.y - start.y;
        const offset = dx * 0.3;
        const c1 = { x: start.x + offset, y: start.y + dy * 0.4 };
        const c2 = { x: end.x - offset, y: start.y + dy * 0.6 };
        return `M ${start.x} ${start.y} C ${c1.x} ${c1.y} ${c2.x} ${c2.y} ${end.x} ${end.y}`;
      };

      const addLine = (fragment, config) => {
        if (!elements.svg) return;
        const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
        path.setAttribute("d", curvedPath(config.start, config.end));
        path.setAttribute("fill", "none");
        path.setAttribute("stroke", config.stroke);
        path.setAttribute("stroke-width", config.width ?? 2);
        path.setAttribute("stroke-linecap", "round");
        path.setAttribute("stroke-dasharray", config.dash ?? "8 4");
        if (config.opacity) path.setAttribute("stroke-opacity", String(config.opacity));
        if (config.animated) path.classList.add(config.direction === "up" ? "flow-up" : "flow-down");
        fragment.appendChild(path);
      };

      const renderLines = () => {
        if (!elements.svg || !elements.inner) return;
        const rect = elements.inner.getBoundingClientRect();
        const width = rect.width;
        const height = rect.height;

        elements.svg.setAttribute("viewBox", `0 0 ${width} ${height}`);
        elements.svg.setAttribute("width", `${width}`);
        elements.svg.setAttribute("height", `${height}`);

        elements.svg.innerHTML = `
          <defs>
            <linearGradient id="lineGradientDown" x1="0%" y1="0%" x2="0%" y2="100%">
              <stop offset="0%" stop-color="#E8A87C" stop-opacity="0.85" />
              <stop offset="100%" stop-color="#E8A87C" stop-opacity="0.25" />
            </linearGradient>
            <linearGradient id="lineGradientUp" x1="0%" y1="0%" x2="0%" y2="100%">
              <stop offset="0%" stop-color="#E8A87C" stop-opacity="0.25" />
              <stop offset="100%" stop-color="#E8A87C" stop-opacity="0.85" />
            </linearGradient>
            <linearGradient id="lineGradientSoft" x1="0%" y1="0%" x2="100%" y2="0%">
              <stop offset="0%" stop-color="#F5C9A8" stop-opacity="0.15" />
              <stop offset="100%" stop-color="#F5C9A8" stop-opacity="0.4" />
            </linearGradient>
          </defs>
        `;

        const fragment = document.createDocumentFragment();

        if (state.step >= 5 && nodes.interfaces.length) {
          const actionsRow = elements.layers.actions?.querySelector(".layer-row");
          const actionsTop = getPoint(actionsRow, "top");
          const interfacesBottom = nodes.interfaces.map((node) => getPoint(node, "bottom"));
          const maxInterfaceBottom = Math.max(...interfacesBottom.map((pt) => pt.y));
          const junction = { x: actionsTop.x, y: maxInterfaceBottom + (actionsTop.y - maxInterfaceBottom) * 0.5 };

          interfacesBottom.forEach((point) => {
            addLine(fragment, { start: point, end: junction, direction: "down", animated: true, stroke: "url(#lineGradientDown)" });
          });
          addLine(fragment, { start: junction, end: actionsTop, direction: "down", animated: true, stroke: "url(#lineGradientDown)" });
        }

        if (state.step >= 4 && nodes.actions.length) {
          const spendTop = getPoint(elements.layers.spend, "top");
          const actionsBottom = nodes.actions.map((node) => getPoint(node, "bottom"));
          const maxActionBottom = Math.max(...actionsBottom.map((pt) => pt.y));
          const junction = { x: spendTop.x, y: maxActionBottom + (spendTop.y - maxActionBottom) * 0.5 };

          actionsBottom.forEach((point) => {
            addLine(fragment, { start: point, end: junction, direction: "down", animated: true, stroke: "url(#lineGradientDown)" });
          });
          addLine(fragment, { start: junction, end: spendTop, direction: "down", animated: true, stroke: "url(#lineGradientDown)" });
        }

        if (state.step >= 2) {
          addLine(fragment, { start: getPoint(elements.layers.spend, "bottom"), end: getPoint(elements.layers.kernel, "top"), direction: "down", animated: true, stroke: "url(#lineGradientDown)" });
        }

        if (state.step >= 3) {
          const kernelBottom = getPoint(elements.layers.kernel, "bottom");
          nodes.adapters.forEach((node) => {
            addLine(fragment, { start: getPoint(node, "top"), end: kernelBottom, direction: "up", animated: true, stroke: "url(#lineGradientUp)" });
          });
          nodes.blockchains.forEach((node, index) => {
            const adapter = nodes.adapters[index];
            if (!adapter) return;
            addLine(fragment, { start: getPoint(node, "top"), end: getPoint(adapter, "bottom"), direction: "up", animated: true, stroke: "url(#lineGradientUp)" });
          });
        }

        if (state.step >= 6 && window.innerWidth >= 640) {
          const kernelRight = getPoint(elements.layers.kernel, "right");
          const foundationLeft = getPoint(elements.layers.foundation, "left");
          addLine(fragment, {
            start: { x: kernelRight.x + 12, y: kernelRight.y },
            end: { x: foundationLeft.x - 12, y: foundationLeft.y },
            direction: "down", animated: false,
            stroke: "url(#lineGradientSoft)", dash: "6 6", opacity: 0.6
          });
        }

        elements.svg.appendChild(fragment);
      };

      const handleResize = () => { layoutLayers(); renderLines(); };

      if (elements.prevButton) elements.prevButton.addEventListener("click", () => setStep(state.step - 1));
      if (elements.nextButton) elements.nextButton.addEventListener("click", () => setStep(state.step + 1));

      window.addEventListener("resize", handleResize);

      if (window.ResizeObserver && elements.inner) {
        const observer = new ResizeObserver(handleResize);
        observer.observe(elements.inner);
      }

      setStep(state.step);
    })();
  </script>
</body>
</html>
